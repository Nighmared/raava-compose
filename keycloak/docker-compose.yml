version: "3.3"
services:
  keycloak:
    image: quay.io/keycloak/keycloak:20.0.2
    restart: unless-stopped
    networks:
      - keycloak
      - db_db
    ports:
      - 8081:8080
    environment:
      - KEYCLOAK_ADMIN=${ADMIN_USERNAME}
      - KEYCLOAK_ADMIN_PASSWORD=${ADMIN_PASSWORD}
      - KC_DB=${DB_TYPE}
      - KC_DB_PASSWORD=${DB_PASSWORD}
      - KC_DB_USERNAME=${DB_USERNAME}
      - KC_DB_URL=${DB_URL}
      - KC_PROXY=edge
      - KC_HOSTNAME_STRICT=false

    command: ["start"]
networks:
  keycloak: null
  db_db:
    external: true
